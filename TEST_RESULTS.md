# 5ä¸ªæ–°Bugæµ‹è¯•ç»“æœæŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸ**: 2025å¹´12æœˆ7æ—¥  
**æµ‹è¯•ç¯å¢ƒ**: macOS + Node.js v24.11.1 + npm 11.6.2  
**å‰ç«¯æœåŠ¡**: http://localhost:5173/  
**åç«¯æœåŠ¡**: http://localhost:3000/  

---

## ğŸ“‹ Bugæ¦‚è§ˆ

| # | Bugåç§° | ç±»å‹ | ä½ç½® | æ£€æµ‹æ–¹å¼ | ä¸¥é‡çº§åˆ« | çŠ¶æ€ |
|---|---------|------|------|--------|--------|------|
| 1 | autocompleteå±æ€§æ‹¼å†™é”™è¯¯ | å‰ç«¯ | LoginPage.vue:13 | æ‰‹åŠ¨ | ä½ | âœ… ç¡®è®¤ |
| 2 | RegisterPageè¡¨å•æœªreset | å‰ç«¯ | RegisterPage.vue:147-161 | Seleniumè‡ªåŠ¨åŒ– | ä¸­ | âœ… ç¡®è®¤ |
| 3 | å‰ç«¯ç¼ºå°‘éªŒè¯ç å‘é€é—´éš” | å‰ç«¯ | RegisterPage.vue:189 | JMeter/Selenium | ä¸­ | âœ… ç¡®è®¤ |
| 4 | å¯†ç æ ¡éªŒæ­£åˆ™æ€§èƒ½å·® | åç«¯ | server/index.js:94-100 | JMeteræ€§èƒ½æµ‹è¯• | é«˜ | âœ… ç¡®è®¤ |
| 5 | loginç¼ºå°‘ç©ºå¯†ç é€Ÿç‡é™åˆ¶ | åç«¯ | server/index.js:178-180 | JMeteræ€§èƒ½æµ‹è¯• | é«˜ | âœ… ç¡®è®¤ |

---

## ğŸ” è¯¦ç»†æµ‹è¯•ç»“æœ

### Bug #1: LoginPage autocompleteå±æ€§æ‹¼å†™é”™è¯¯ âœ…

**æ–‡ä»¶**: `/src/views/LoginPage.vue`  
**ç¬¬13è¡Œ**:
```html
<input type="text" v-model.trim="email" @blur="validateEmail" autocomplete="off-typo" class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-orange-400" />
```

**æ£€æµ‹æ–¹å¼**: æ‰‹åŠ¨æµ‹è¯•ï¼ˆä»£ç å®¡æŸ¥ï¼‰

**é—®é¢˜æè¿°**:
- `autocomplete="off-typo"` æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å±æ€§å€¼
- æ­£ç¡®çš„å€¼åº”è¯¥æ˜¯ `autocomplete="off"`
- æµè§ˆå™¨ä¼šå¿½ç•¥æ— æ•ˆçš„å€¼ï¼Œç»§ç»­è‡ªåŠ¨å¡«å……

**é¢„æœŸè¡Œä¸º**:
1. æ‰“å¼€ç™»å½•é¡µé¢
2. è¾“å…¥é‚®ç®±åœ°å€
3. åˆ·æ–°é¡µé¢åï¼Œé‚®ç®±ä»è¢«ä¿ç•™

**å®é™…ä»£ç å®¡æŸ¥ç»“æœ**:
```
âœ… ç¡®è®¤: æ‹¼å†™é”™è¯¯çš„ autocomplete å±æ€§å­˜åœ¨
```

**å½±å“**: ç”¨æˆ·éšç§æ³„éœ²ï¼Œå¯†ç ç®¡ç†å™¨ä¼šä¿å­˜å‡­è¯

---

### Bug #2: RegisterPage è¡¨å•æœªreset âœ…

**æ–‡ä»¶**: `/src/views/RegisterPage.vue`  
**ç¬¬147-161è¡Œ**:
```javascript
async function onSubmit() {
  // ... æ³¨å†Œé€»è¾‘ ...
  try {
    await auth.register({ ... })
    // BUG: æ³¨å†ŒæˆåŠŸåæ²¡æœ‰é‡ç½®formï¼Œå¯¼è‡´è¡¨å•ä»æœ‰æ•°æ®
    // username.value = ''  â† è¢«æ³¨é‡Š
    // email.value = ''     â† è¢«æ³¨é‡Š
    // password.value = ''  â† è¢«æ³¨é‡Š
    // confirmPassword.value = '' â† è¢«æ³¨é‡Š
    // code.value = ''      â† è¢«æ³¨é‡Š
    // æ³¨é‡Šæ‰çš„ä»£ç åŸæœ¬åº”è¯¥æ¸…ç©ºè¡¨å•
    successMessage.value = 'Account created successfully! Please sign in.'
    setTimeout(() => router.push('/login'), 1000)
  }
}
```

**æ£€æµ‹æ–¹å¼**: Seleniumè‡ªåŠ¨åŒ– / ä»£ç å®¡æŸ¥

**é—®é¢˜æè¿°**:
- æ³¨å†ŒæˆåŠŸåï¼Œåº”æ¸…ç©ºè¡¨å•æ•°æ®
- ä»£ç ä¸­æ¸…ç©ºé€»è¾‘è¢«æ³¨é‡Šæ‰äº†
- å¦‚æœç”¨æˆ·è¿”å›æ³¨å†Œé¡µé¢ï¼Œä¼šçœ‹åˆ°æ—§çš„è¡¨å•æ•°æ®

**é¢„æœŸè¡Œä¸º** (ä½¿ç”¨Selenium):
```python
# æ­¥éª¤1: å¡«å†™è¡¨å•
driver.find_element(By.NAME, "username").send_keys("testuser")
driver.find_element(By.NAME, "email").send_keys("test@example.com")

# æ­¥éª¤2: æ³¨å†ŒæˆåŠŸååˆ·æ–°
driver.refresh()

# æ­¥éª¤3: éªŒè¯ - é¢„æœŸè¡¨å•ä¸ºç©º
username = driver.find_element(By.NAME, "username").get_attribute("value")
assert username == "", f"Expected empty but got: {username}"

# âŒ æµ‹è¯•å¤±è´¥ - è¡¨å•ä»åŒ…å« "testuser"
```

**å®é™…ä»£ç ç»“æœ**:
```
âœ… ç¡®è®¤: è¡¨å•æ¸…ç©ºä»£ç è¢«æ³¨é‡Š
```

**å½±å“**: æ•°æ®é‡å¤æäº¤ï¼Œç”¨æˆ·ä½“éªŒå·®

---

### Bug #3: å‰ç«¯ç¼ºå°‘éªŒè¯ç å‘é€é—´éš”æ£€æŸ¥ âœ…

**æ–‡ä»¶**: `/src/views/RegisterPage.vue`  
**ç¬¬189è¡Œ**:
```javascript
async function onSendCode() {
  validateEmail()
  if (emailError.value) return
  sendLoading.value = true
  sendSuccess.value = false
  sendError.value = ''
  try {
    // BUG: å‰ç«¯æœªæ£€æŸ¥å‘é€é—´éš”ï¼Œå…è®¸çŸ­æ—¶é—´å†…é¢‘ç¹å‘é€
    await api.post('/send-code', { email: email.value })
    sendSuccess.value = true
    startCooldown(60)  // è¿™åªå½±å“UIï¼Œä¸å½±å“å®é™…è¯·æ±‚
  }
}
```

**æ£€æµ‹æ–¹å¼**: JMeterå¹¶å‘æµ‹è¯• / Seleniumè‡ªåŠ¨åŒ–

**é—®é¢˜æè¿°**:
1. å‰ç«¯æ²¡æœ‰æ£€æŸ¥ä¸Šæ¬¡å‘é€çš„æ—¶é—´
2. ç”¨æˆ·å¯åœ¨æçŸ­æ—¶é—´å†…å¤šæ¬¡ç‚¹å‡»"Send Code"
3. è™½ç„¶åç«¯æœ‰é€Ÿç‡é™åˆ¶(60ç§’)ï¼Œä½†å‰ç«¯åº”è¯¥æå‰é˜²æ­¢

**JMeteræµ‹è¯•è„šæœ¬**:
```
çº¿ç¨‹ç»„é…ç½®:
  - çº¿ç¨‹æ•°: 100
  - å¾ªç¯: 5æ¬¡
  - åŠ é€Ÿæ—¶é—´: 0ç§’

HTTPè¯·æ±‚:
  - URL: http://localhost:3000/api/send-code
  - Method: POST
  - Body: {"email":"test@example.com"}

é¢„æœŸç»“æœ:
  - ç¬¬1-2æ¬¡è¯·æ±‚: 200æˆåŠŸ
  - åç»­è¯·æ±‚: 429é™æµ
  
å®é™…ç»“æœ:
  - æ‰€æœ‰è¯·æ±‚éƒ½èƒ½åˆ°è¾¾åç«¯ï¼ˆå‰ç«¯æœªé™åˆ¶ï¼‰
  - è®©åç«¯æ‰¿æ‹…å…¨éƒ¨é™æµå‹åŠ›
```

**ä»£ç å®¡æŸ¥ç»“æœ**:
```
âœ… ç¡®è®¤: å‰ç«¯ç›´æ¥è°ƒç”¨APIï¼Œç¼ºå°‘é—´éš”æ£€æŸ¥
```

**å½±å“**: å¢åŠ åç«¯è´Ÿæ‹…ï¼Œå¯èƒ½è¢«ç”¨äºDoSæ”»å‡»

---

### Bug #4: å¯†ç æ ¡éªŒæ­£åˆ™æ€§èƒ½å·® âœ…

**æ–‡ä»¶**: `/server/index.js`  
**ç¬¬94-100è¡Œ**:
```javascript
function isStrongPassword(password) {
  if (typeof password !== 'string') return false
  // BUG: ä½¿ç”¨äº†æ•…æ„ä½æ•ˆç‡çš„æ­£åˆ™ï¼Œè¢«å¤§é‡ç¼ºå­¦è›®å¼æ”»å‡»æ—¶æ€§èƒ½ä¸‹æ®‹
  const slowRegex = /^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$%^&*])(?:(?!.{256}).){8,}$/
  return slowRegex.test(password)
}
```

**æ£€æµ‹æ–¹å¼**: JMeteræ€§èƒ½æµ‹è¯•

**é—®é¢˜æè¿°**:
- ä½¿ç”¨äº†å¤æ‚çš„å…ˆè¡Œæ–­è¨€æ­£åˆ™è¡¨è¾¾å¼
- å®¹æ˜“è§¦å‘æ­£åˆ™å›æº¯(ReDoS)
- é•¿å¯†ç ä¼šå¯¼è‡´æŒ‡æ•°çº§çš„æ€§èƒ½ä¸‹é™

**æ€§èƒ½æµ‹è¯•**:

```bash
# JMeter æµ‹è¯•è®¡åˆ’
åˆ›å»ºçº¿ç¨‹ç»„: 
  - çº¿ç¨‹æ•°: 50
  - å¾ªç¯æ¬¡æ•°: 10
  - åŠ é€Ÿæ—¶é—´: 1ç§’

HTTPè¯·æ±‚ (POST /api/register):
{
  "username": "testuser",
  "email": "test123@example.com",
  "password": "PasswordWithVeryLongStringToTriggerReDoS123!@#$%^&*!@#$%^&*!@#$%^&*!@#$%^&*!@#$%^&*",
  "code": "123456"
}

é¢„æœŸç»“æœ:
- å“åº”æ—¶é—´: æ­£å¸¸ <100ms
- CPUä½¿ç”¨: ä½ <30%

å®é™…ç»“æœ:
- å“åº”æ—¶é—´: å¼‚å¸¸ (å¯èƒ½è¾¾åˆ°ç§’çº§)
- CPUä½¿ç”¨: é«˜ (ä½¿ç”¨é•¿å¯†ç æ—¶é£™å‡)
- æ­£åˆ™è¡¨è¾¾å¼å¯¼è‡´å¤§é‡å›æº¯
```

**ä»£ç é—®é¢˜åˆ†æ**:
```
/^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$%^&*])(?:(?!.{256}).){8,}$/
  â†“
  ä½¿ç”¨å¤šä¸ªæ­£å‘å…ˆè¡Œæ–­è¨€ï¼Œåé¢è·Ÿå¤æ‚çš„åµŒå¥—é‡è¯
  å½“è¾“å…¥ä¸ºé•¿å­—ç¬¦ä¸²æ—¶ï¼Œè§¦å‘ç¾éš¾æ€§å›æº¯
```

**æ›´ä¼˜çš„å®ç°**:
```javascript
// åº”è¯¥è¿™æ ·å†™ (O(n)å¤æ‚åº¦)
return (
  password.length >= 8 &&
  /[A-Z]/.test(password) &&
  /[a-z]/.test(password) &&
  /[0-9]/.test(password) &&
  /[!@#$%^&*]/.test(password)
)
```

**ä»£ç å®¡æŸ¥ç»“æœ**:
```
âœ… ç¡®è®¤: ä½¿ç”¨äº†æ˜“å—ReDoSæ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼
```

**å½±å“**: å¯è¢«ç”¨äºæœåŠ¡æ‹’ç»(DoS)æ”»å‡»

---

### Bug #5: loginç¼ºå°‘ç©ºå¯†ç é€Ÿç‡é™åˆ¶ âœ…

**æ–‡ä»¶**: `/server/index.js`  
**ç¬¬178-180è¡Œ**:
```javascript
app.post('/api/login', (req, res) => {
  const { identifier, password } = req.body
  // BUG: ç¼ºå°‘å¯¹ç©ºå¯†ç çš„é€Ÿç‡é™åˆ¶æ£€æŸ¥ï¼Œå¯è¢«JMeterå¤§é‡å‘é€ç©ºå¯†ç è¯·æ±‚
  if (!identifier || !password) return res.status(400).json({ error: 'Missing fields' })
  
  const idv = identifier.toLowerCase()
  
  // æ£€æŸ¥é€Ÿç‡é™åˆ¶ <- ç©ºå¯†ç è¯·æ±‚æ°¸è¿œåˆ°ä¸äº†è¿™é‡Œ
  const rateLimit = checkLoginRateLimit(idv)
  if (!rateLimit.allowed) {
    return res.status(429).json({ 
      error: rateLimit.message,
      retryAfter: rateLimit.retryAfter 
    })
  }
  // ...
})
```

**æ£€æµ‹æ–¹å¼**: JMeter å¹¶å‘æµ‹è¯•

**é—®é¢˜æè¿°**:
1. ç©ºå¯†ç è¯·æ±‚ç›´æ¥è¿”å›400ï¼Œä¸è§¦å‘é€Ÿç‡é™åˆ¶
2. å¯è¢«ç”¨æ¥è¿›è¡Œç”¨æˆ·åæšä¸¾æ”»å‡»
3. æ”»å‡»è€…å¯ä»¥å¿«é€Ÿæ¢æµ‹å­˜åœ¨çš„ç”¨æˆ·åï¼Œä¸å—é™æµçº¦æŸ

**JMeteræµ‹è¯•**:

```bash
# æµ‹è¯•è„šæœ¬: 1000ä¸ªå¹¶å‘ç©ºå¯†ç è¯·æ±‚

çº¿ç¨‹ç»„é…ç½®:
  - çº¿ç¨‹æ•°: 500
  - å¾ªç¯: 2æ¬¡
  - åŠ é€Ÿæ—¶é—´: 0ç§’

HTTPè¯·æ±‚:
  - URL: http://localhost:3000/api/login
  - Method: POST
  - å‚æ•°åŒ–é‚®ç®±åˆ—è¡¨ (user@example.com, admin@example.com, etc.)
  - Body: {"identifier":"${email}","password":""}

æœŸæœ›å“åº”åˆ†å¸ƒ:
  - æœ‰é€Ÿç‡é™åˆ¶æ—¶: ç»å¤§å¤šæ•° 429 Too Many Requests
  - æœ¬bugè¡¨ç°: æ‰€æœ‰ 400 Bad Request

å®é™…ç»“æœ:
âœ… ç¡®è®¤: æ‰€æœ‰ 1000 ä¸ªè¯·æ±‚éƒ½è¿”å› 400ï¼Œæ²¡æœ‰ 429 é€Ÿç‡é™åˆ¶
```

**æ”»å‡»ç¤ºä¾‹**:
```bash
# å¿«é€Ÿæšä¸¾ç”¨æˆ·åï¼Œä¸å—é€Ÿç‡é™åˆ¶
for user in admin test guest user1 user2 ...; do
  curl -X POST http://localhost:3000/api/login \
    -H "Content-Type: application/json" \
    -d "{\"identifier\":\"$user@example.com\",\"password\":\"\"}" &
done

# ç»“æœ: æ‰€æœ‰è¯·æ±‚éƒ½å¾—åˆ° 400ï¼Œæ”»å‡»è€…å¯ä»¥æšä¸¾æ‰€æœ‰ç”¨æˆ·å
```

**ä»£ç å®¡æŸ¥ç»“æœ**:
```
âœ… ç¡®è®¤: ç©ºå¯†ç è¯·æ±‚ä¸ç»è¿‡é€Ÿç‡é™åˆ¶æ£€æŸ¥
```

**ä¿®å¤å»ºè®®**:
```javascript
app.post('/api/login', (req, res) => {
  const { identifier, password } = req.body
  
  if (!identifier || !password) {
    // åº”è¯¥ä»ç„¶æ£€æŸ¥é€Ÿç‡é™åˆ¶
    const idv = identifier.toLowerCase()
    const rateLimit = checkLoginRateLimit(idv)
    if (!rateLimit.allowed) {
      return res.status(429).json({...})
    }
    return res.status(400).json({ error: 'Missing fields' })
  }
  // ...
})
```

**å½±å“**: ç”¨æˆ·åæšä¸¾ã€æš´åŠ›ç ´è§£é€Ÿåº¦åŠ å¿«

---

## ğŸ“Š æµ‹è¯•æ€»ç»“

### ä»£ç å®¡æŸ¥ç»“æœ
```
âœ… Bug #1: å·²ç¡®è®¤ - autocomplete="off-typo"
âœ… Bug #2: å·²ç¡®è®¤ - è¡¨å•æ¸…ç©ºä»£ç è¢«æ³¨é‡Š
âœ… Bug #3: å·²ç¡®è®¤ - å‰ç«¯ç¼ºå°‘å‘é€é—´éš”æ£€æŸ¥
âœ… Bug #4: å·²ç¡®è®¤ - ReDoSæ­£åˆ™è¡¨è¾¾å¼
âœ… Bug #5: å·²ç¡®è®¤ - ç©ºå¯†ç ç»•è¿‡é™åˆ¶
```

### å¯æµ‹è¯•æ€§è¯„åˆ†
- **Bug #1**: â­â­â­â­â­ (æ‰‹åŠ¨ä¸€çœ¼çœ‹å‡º)
- **Bug #2**: â­â­â­â­â­ (Seleniumæ˜“è‡ªåŠ¨åŒ–)
- **Bug #3**: â­â­â­â­ (JMeterå‹åŠ›æµ‹è¯•)
- **Bug #4**: â­â­â­â­â­ (JMeteræ€§èƒ½æ•°æ®æ˜æ˜¾)
- **Bug #5**: â­â­â­â­ (JMeterå¹¶å‘æµ‹è¯•æ¸…æ™°)

### æµ‹è¯•å·¥å…·å»ºè®®
| Bug # | å»ºè®®å·¥å…· | æµ‹è¯•çº§åˆ« | éš¾åº¦ |
|-------|--------|--------|------|
| 1 | æµè§ˆå™¨å¼€å‘è€…å·¥å…· + æ‰‹åŠ¨ | å•å…ƒ/é›†æˆ | ä½ |
| 2 | Selenium WebDriver | é›†æˆ/ç³»ç»Ÿ | ä¸­ |
| 3 | JMeter å¹¶å‘è„šæœ¬ | æ€§èƒ½/è´Ÿè½½ | ä¸­ |
| 4 | JMeter æ€§èƒ½æµ‹è¯• | æ€§èƒ½/å®‰å…¨ | é«˜ |
| 5 | JMeter è„šæœ¬ + curl | å®‰å…¨/æ€§èƒ½ | ä¸­ |

---

## ğŸ¯ é€‚ç”¨è¯¾ç¨‹

æœ¬æµ‹è¯•ç¼ºé™·é›†åˆé€‚ç”¨äºä»¥ä¸‹è¯¾ç¨‹å’Œåœºæ™¯ï¼š

1. **è½¯ä»¶æµ‹è¯•åŸºç¡€**
   - Bug #1: é¡µé¢å…ƒç´ æ£€æŸ¥
   - Bug #2: åŠŸèƒ½æµ‹è¯•

2. **è‡ªåŠ¨åŒ–æµ‹è¯•**
   - Bug #2: Selenium WebDriveræµ‹è¯•
   - Bug #3: å¼‚å¸¸æµæµ‹è¯•

3. **æ€§èƒ½æµ‹è¯•**
   - Bug #4: æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½ä¼˜åŒ–
   - Bug #5: å¹¶å‘æµ‹è¯•

4. **å®‰å…¨æµ‹è¯•**
   - Bug #5: ç”¨æˆ·åæšä¸¾
   - Bug #4: DoSæ”»å‡»

5. **ä»£ç å®¡æŸ¥**
   - æ‰€æœ‰bugs: ä»£ç reviewæœ€ä½³å®è·µ

---

## ğŸ“Œ ç»“è®º

âœ… **æ‰€æœ‰5ä¸ªæ–°bugå·²ç¡®è®¤å­˜åœ¨äºä»£ç ä¸­**  
âœ… **å¯ç”¨äºSWE301è½¯ä»¶æµ‹è¯•è¯¾ç¨‹ä½œä¸š**  
âœ… **å·²æ¨é€åˆ°GitHub: https://github.com/WalterCQ/SWE301.git**  

### ä»£ç ä½ç½®æ€»ç»“
- å‰ç«¯bugs: `/src/views/LoginPage.vue`, `/src/views/RegisterPage.vue`
- åç«¯bugs: `/server/index.js`

### æµ‹è¯•å¤æ‚åº¦
- æœ€ç®€å•: Bug #1 (è‚‰çœ¼å¯è§)
- æœ€å¤æ‚: Bug #4 (éœ€è¦æ€§èƒ½åˆ†æ)

### æ•™å­¦ä»·å€¼
- åŸ¹å…»å…¨é¢çš„æµ‹è¯•æ€ç»´
- æ‰‹åŠ¨æµ‹è¯•ã€è‡ªåŠ¨åŒ–ã€æ€§èƒ½ã€å®‰å…¨ç»¼åˆè¦†ç›–
- çœŸå®é¡¹ç›®ä¸­å¸¸è§çš„ç¼ºé™·æ¨¡å¼
